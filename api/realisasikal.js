const oracledb = require('oracledb');

// Setel mode thin client
oracledb.initOracleClient({ libDir: '' });

export default async (req, res) => {
    // Ambil parameter dan autentikasi
    const { tahun, tglawal, tglakhir } = req.query;
    const clientApiKey = req.headers['x-api-key'];
    const vercelApiKey = process.env.VERCEL_API_KEY;

    if (clientApiKey !== vercelApiKey) {
        return res.status(403).json({ error: 'Forbidden: Invalid API Key.' });
    }
    
    // Periksa parameter
    if (!tahun || !tglawal || !tglakhir) {
        return res.status(400).json({ error: 'Missing required query parameters.' });
    }

    let connection;
    try {
        // --- KONEKSI KE DATABASE ORACLE ---
        connection = await oracledb.getConnection({
         user: process.env.DB_USER,
         password: process.env.DB_PASSWORD,
         connectString: process.env.DB_HOST + ':' + process.env.DB_PORT + '/SISMIOP',
         });

        // --- Kueri Database ---
        const queryText = `SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '010' AND
A.KD_KELURAHAN = '001' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '001' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '001' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '010' AND
A.KD_KELURAHAN = '002' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.002.001-0171.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.002.002-0314.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '002' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340101000200101710' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340101000200203140' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '002' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '010' AND
A.KD_KELURAHAN = '003' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.003.004-0499.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.003.006-0001.0' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '003' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.010.003.004-0499.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.010.003.006-0001.0'
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir
) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '003' 


) F

)


UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '010' AND
A.KD_KELURAHAN = '004' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.004.007-0151.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.004.008-0235.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.004.008-0251.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.004.010-0001.0' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '004' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340101000400701510' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340101000400802350' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340101000400802510' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340101000401000010' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '004' 


) F

)

UNION ALL
-----> MULAI 005

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '010' AND
A.KD_KELURAHAN = '005' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '005' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '005' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '010' AND
A.KD_KELURAHAN = '006' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.006.006-0327.0' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '006' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340101000600603270' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '006' 


) F

)


UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '010' AND
A.KD_KELURAHAN = '007' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.007.001-0158.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.007.008-0016.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '007' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340101000700101580' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340101000700800160' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '007' 


) F

)


UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '010' AND
A.KD_KELURAHAN = '008' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.008.001-0192.0' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '008' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340101000800101920'

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '008' 


) F

)

UNION ALL


SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '010' AND
A.KD_KELURAHAN = '009' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '009' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '009' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '010' AND
A.KD_KELURAHAN = '010' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '010' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '010' 


) F

)


UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '010' AND
A.KD_KELURAHAN = '011' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.011.002-0222.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.011.006-0310.0' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '011' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340101001100202220' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340101001100603100' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '011' 


) F

)


UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '010' AND
A.KD_KELURAHAN = '012' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.012.003-0145.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.012.003-0156.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.012.003-0170.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.012.003-0230.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.012.006-0008.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.012.006-0227.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.010.012.007-0006.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '012' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340101001200301450' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340101001200301560' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340101001200301700' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340101001200302300' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340101001200600080' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340101001200602270' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340101001200700060' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '012' 


) F

)

UNION ALL


SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '010' AND
A.KD_KELURAHAN = '013' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '013' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '013' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '010' AND
A.KD_KELURAHAN = '014' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '014' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '014' 


) F

)


UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '010' AND
A.KD_KELURAHAN = '015' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '015' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '010' AND
B.KD_KELURAHAN = '015' 


) F

)

----------------------------------------------------------->MULAI WATES
UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '020' AND
A.KD_KELURAHAN = '001' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.001.012-0465.0' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '020' AND
B.KD_KELURAHAN = '001' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.001.012-0465.0'

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '020' AND
B.KD_KELURAHAN = '001' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '020' AND
A.KD_KELURAHAN = '002' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.002.001-0131.0' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '020' AND
B.KD_KELURAHAN = '002' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.002.001-0131.0'
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '020' AND
B.KD_KELURAHAN = '002' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '020' AND
A.KD_KELURAHAN = '003' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.003.001-0036.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.003.001-0155.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.003.002-0053.0' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '020' AND
B.KD_KELURAHAN = '003' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.003.001-0036.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.003.001-0155.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.003.002-0053.0'

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '020' AND
B.KD_KELURAHAN = '003' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '020' AND
A.KD_KELURAHAN = '004' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '020' AND
B.KD_KELURAHAN = '004' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '020' AND
B.KD_KELURAHAN = '004' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '020' AND
A.KD_KELURAHAN = '005' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.005.012-0251.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.005.012-0270.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.005.013-0155.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.005.013-0233.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '020' AND
B.KD_KELURAHAN = '005' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.005.012-0251.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.005.012-0270.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.005.013-0155.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.005.013-0233.0'

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '020' AND
B.KD_KELURAHAN = '005' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '020' AND
A.KD_KELURAHAN = '006' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.006.003-0480.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.006.007-0242.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.006.008-0010.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.006.014-0257.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.006.017-0001.0' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '020' AND
B.KD_KELURAHAN = '006' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.006.003-0480.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.006.007-0242.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.006.008-0010.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.006.014-0257.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.006.017-0001.0'
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '020' AND
B.KD_KELURAHAN = '006' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '020' AND
A.KD_KELURAHAN = '007' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.007.003-0145.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.007.006-0257.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.007.008-0030.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.007.008-0269.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.007.008-0410.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.007.009-0007.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.007.009-0074.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.007.009-0104.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.007.009-0121.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '020' AND
B.KD_KELURAHAN = '007' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.007.003-0145.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.007.006-0257.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.007.008-0030.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.007.008-0269.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.007.008-0410.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.007.009-0007.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.007.009-0074.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.007.009-0104.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.007.009-0121.0'
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '020' AND
B.KD_KELURAHAN = '007' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '020' AND
A.KD_KELURAHAN = '008' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.008-0177.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.008-0182.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.008-0308.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.008-0309.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.008-0310.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.008-0311.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.008-0315.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.008-0321.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.008-0323.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.008-0325.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.008-0327.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.008-0328.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.008-0330.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.008-0333.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.008-0335.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.009-0087.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.009-0123.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.009-0207.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.009-0244.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.010-0001.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.010-0004.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.010-0173.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.010-0176.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.010-0187.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.010-0218.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.013-0001.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.015-0051.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.016-0039.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.018-0058.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.019-0048.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.020-0002.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.020-0104.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.020-0154.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.020-0202.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.021-0053.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.022-0209.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.022-0264.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.023-0002.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.023-0007.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.020.008.007-0242.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '020' AND
B.KD_KELURAHAN = '008' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.008-0177.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.008-0182.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.008-0308.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.008-0309.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.008-0310.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.008-0311.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.008-0315.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.008-0321.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.008-0323.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.008-0325.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.008-0327.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.008-0328.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.008-0330.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.008-0333.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.008-0335.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.009-0087.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.009-0123.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.009-0207.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.009-0244.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.010-0001.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.010-0004.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.010-0173.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.010-0176.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.010-0187.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.010-0218.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.013-0001.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.015-0051.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.016-0039.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.018-0058.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.019-0048.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.020-0002.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.020-0104.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.020-0154.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.020-0202.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.021-0053.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.022-0209.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.022-0264.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.023-0002.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.023-0007.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.020.008.007-0242.0'

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '020' AND
B.KD_KELURAHAN = '008' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '030' AND
A.KD_KELURAHAN = '001' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.030.001.004-0287.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.030.001.007-0294.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '001' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340103000100402870' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340103000100702940' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '001' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '030' AND
A.KD_KELURAHAN = '002' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.030.002.005-0170.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.030.002.005-0176.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '002' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340103000200501700' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340103000200501760' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '002' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '030' AND
A.KD_KELURAHAN = '003' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.030.003.011-0614.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '003' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340103000301106140'

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '003' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '030' AND
A.KD_KELURAHAN = '004' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '004' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '004' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '030' AND
A.KD_KELURAHAN = '005' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '005' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '005' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '030' AND
A.KD_KELURAHAN = '006' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '006' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '006' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '030' AND
A.KD_KELURAHAN = '007' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '007' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '007' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '030' AND
A.KD_KELURAHAN = '008' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '008' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '008' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '030' AND
A.KD_KELURAHAN = '009' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.030.009.002-0091.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.030.009.006-0161.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '009' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340103000900200910' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340103000900601610' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '009' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '030' AND
A.KD_KELURAHAN = '010' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '010' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '010' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '030' AND
A.KD_KELURAHAN = '011' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.030.011.005-0339.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '011' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340103001100503390' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '030' AND
B.KD_KELURAHAN = '011' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '040' AND
A.KD_KELURAHAN = '001' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.040.001.003-0146.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.040.001.005-0225.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.040.001.018-0127.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '040' AND
B.KD_KELURAHAN = '001' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340104000100301460' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340104000100502250' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340104000101801270' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '040' AND
B.KD_KELURAHAN = '001' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '040' AND
A.KD_KELURAHAN = '002' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '040' AND
B.KD_KELURAHAN = '002' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '040' AND
B.KD_KELURAHAN = '002' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '040' AND
A.KD_KELURAHAN = '003' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '040' AND
B.KD_KELURAHAN = '003' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '040' AND
B.KD_KELURAHAN = '003' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '040' AND
A.KD_KELURAHAN = '004' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '040' AND
B.KD_KELURAHAN = '004' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '040' AND
B.KD_KELURAHAN = '004' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '040' AND
A.KD_KELURAHAN = '005' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.040.005.004-0052.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.040.005.004-0269.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.040.005.005-0010.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '040' AND
B.KD_KELURAHAN = '005' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340104000500400520' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340104000500402690' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340104000500500100' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '040' AND
B.KD_KELURAHAN = '005' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '040' AND
A.KD_KELURAHAN = '006' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '040' AND
B.KD_KELURAHAN = '006' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '040' AND
B.KD_KELURAHAN = '006' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '040' AND
A.KD_KELURAHAN = '007' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.040.007.016-0265.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.040.007.023-0110.0' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '040' AND
B.KD_KELURAHAN = '007' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340104000701602650' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340104000702301100' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '040' AND
B.KD_KELURAHAN = '007' 


) F

)
UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '050' AND
A.KD_KELURAHAN = '001' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.050.001.006-0110.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '050' AND
B.KD_KELURAHAN = '001' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340105000100601100' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir
) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '050' AND
B.KD_KELURAHAN = '001' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '050' AND
A.KD_KELURAHAN = '002' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.050.002.030-0048.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.050.002.032-0082.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.050.002.032-0106.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.050.002.032-0119.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '050' AND
B.KD_KELURAHAN = '002' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340105000203000480' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340105000203200820' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340105000203201060' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340105000203201190' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '050' AND
B.KD_KELURAHAN = '002' 


) F

)
UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '050' AND
A.KD_KELURAHAN = '003' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.050.003.016-0181.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.050.003.029-0174.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '050' AND
B.KD_KELURAHAN = '003' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340105000301601810' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340105000302901740' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '050' AND
B.KD_KELURAHAN = '003' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '050' AND
A.KD_KELURAHAN = '004' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '050' AND
B.KD_KELURAHAN = '004' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '050' AND
B.KD_KELURAHAN = '004' 


) F

)
UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '050' AND
A.KD_KELURAHAN = '005' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.050.005.011-0123.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.050.005.025-0185.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '050' AND
B.KD_KELURAHAN = '005' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340105000501101230' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340105000502501850' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '050' AND
B.KD_KELURAHAN = '005' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '050' AND
A.KD_KELURAHAN = '006' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '050' AND
B.KD_KELURAHAN = '006' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '050' AND
B.KD_KELURAHAN = '006' 


) F

)
UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '060' AND
A.KD_KELURAHAN = '001' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.001.003-0205.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.001.002-0335.0' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '060' AND
B.KD_KELURAHAN = '001' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.060.001.003-0205.0' AND
(B.KD_PROPINSI|| '.' ||B.KD_DATI2|| '.' ||B.KD_KECAMATAN|| '.' ||B.KD_KELURAHAN|| '.' ||B.KD_BLOK|| '-' ||B.NO_URUT|| '.' ||B.KD_JNS_OP) <>'34.01.060.001.002-0335.0' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '060' AND
B.KD_KELURAHAN = '001' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '060' AND
A.KD_KELURAHAN = '002' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.002.003-0254.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.002.015-0106.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.002.016-0139.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '060' AND
B.KD_KELURAHAN = '002' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000200302540' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000201501060' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000201601390' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '060' AND
B.KD_KELURAHAN = '002' 


) F

)
UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '060' AND
A.KD_KELURAHAN = '003' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.003.008-0001.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.003.008-0407.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.003.015-0164.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.003.015-0296.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.003.008-0221.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '060' AND
B.KD_KELURAHAN = '003' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000300800010' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000300804070' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000301501640' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000301502960' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000300802210' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '060' AND
B.KD_KELURAHAN = '003' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '060' AND
A.KD_KELURAHAN = '004' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.004.005-0528.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.004.006-0175.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.004.006-0473.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.004.007-0426.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '060' AND
B.KD_KELURAHAN = '004' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000400505280' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000400601750' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000400604730' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000400704260' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '060' AND
B.KD_KELURAHAN = '004' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '060' AND
A.KD_KELURAHAN = '005' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.005.003-0396.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.005.005-0110.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.005.006-0103.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.005.018-0153.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '060' AND
B.KD_KELURAHAN = '005' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000500303960' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000500501100' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000500601030' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000501801530' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '060' AND
B.KD_KELURAHAN = '005' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '060' AND
A.KD_KELURAHAN = '006' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.006.006-0373.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '060' AND
B.KD_KELURAHAN = '006' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000600603730' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '060' AND
B.KD_KELURAHAN = '006' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '060' AND
A.KD_KELURAHAN = '007' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.007.003-0394.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.007.004-0106.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.007.005-0337.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.007.005-0437.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.007.007-0035.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.007.007-0280.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.007.007-0425.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.007.007-0556.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.007.010-0007.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.007.010-0412.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.007.011-0232.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '060' AND
B.KD_KELURAHAN = '007' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000700303940' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000700401060' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000700503370' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000700504370' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000700700350' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000700702800' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000700704250' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000700705560' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000701000070' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000701004120' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000701102320' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '060' AND
B.KD_KELURAHAN = '007' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '060' AND
A.KD_KELURAHAN = '008' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.008.007-0014.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.008.007-0015.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.008.007-0020.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.008.007-0027.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.060.008.009-0006.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '060' AND
B.KD_KELURAHAN = '008' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000800700140' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000800700150' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000800700200' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000800700270' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340106000800900060' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '060' AND
B.KD_KELURAHAN = '008' 


) F

)
UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '070' AND
A.KD_KELURAHAN = '001' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.070.001.003-0074.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '070' AND
B.KD_KELURAHAN = '001' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340107000100300740' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '070' AND
B.KD_KELURAHAN = '001' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '070' AND
A.KD_KELURAHAN = '002' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.070.002.030-0201.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '070' AND
B.KD_KELURAHAN = '002' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340107000203002010' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '070' AND
B.KD_KELURAHAN = '002' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '070' AND
A.KD_KELURAHAN = '003' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.070.003.016-0049.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.070.003.027-0221.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.070.003.027-0320.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '070' AND
B.KD_KELURAHAN = '003' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340107000301600490' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340107000302702210' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340107000302703200' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '070' AND
B.KD_KELURAHAN = '003' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '070' AND
A.KD_KELURAHAN = '004' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.070.004.004-0164.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.070.004.017-0055.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.070.004.019-0068.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '070' AND
B.KD_KELURAHAN = '004' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340107000400401640' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340107000401700550' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340107000401900680' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '070' AND
B.KD_KELURAHAN = '004' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '070' AND
A.KD_KELURAHAN = '005' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.070.005.013-0192.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.070.005.014-0206.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.070.005.022-0043.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '070' AND
B.KD_KELURAHAN = '005' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340107000501301920' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340107000501402060' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340107000502200430' 


AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '070' AND
B.KD_KELURAHAN = '005' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '070' AND
A.KD_KELURAHAN = '006' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.070.006.002-0078.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.070.006.013-0122.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.070.006.018-0035.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.070.006.020-0013.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '070' AND
B.KD_KELURAHAN = '006' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340107000600200780' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340107000601301220' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340107000601800350' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340107000602000130' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '070' AND
B.KD_KELURAHAN = '006' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '070' AND
A.KD_KELURAHAN = '007' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '070' AND
B.KD_KELURAHAN = '007' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '070' AND
B.KD_KELURAHAN = '007' 


) F

)
UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '080' AND
A.KD_KELURAHAN = '001' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.080.001.009-0455.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '080' AND
B.KD_KELURAHAN = '001' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340108000100904550' 


AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '080' AND
B.KD_KELURAHAN = '001' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '080' AND
A.KD_KELURAHAN = '002' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.080.002.016-0565.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '080' AND
B.KD_KELURAHAN = '002' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340108000201605650' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '080' AND
B.KD_KELURAHAN = '002' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '080' AND
A.KD_KELURAHAN = '003' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.080.003.024-0098.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.080.003.024-0099.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.080.003.024-0103.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '080' AND
B.KD_KELURAHAN = '003' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340108000302400980' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340108000302400990' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340108000302401030' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '080' AND
B.KD_KELURAHAN = '003' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '080' AND
A.KD_KELURAHAN = '004' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '080' AND
B.KD_KELURAHAN = '004' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '080' AND
B.KD_KELURAHAN = '004' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '080' AND
A.KD_KELURAHAN = '005' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '080' AND
B.KD_KELURAHAN = '005' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '080' AND
B.KD_KELURAHAN = '005' 


) F

)
UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '090' AND
A.KD_KELURAHAN = '001' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.090.001.009-0052.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.090.001.009-0055.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.090.001.011-0147.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '090' AND
B.KD_KELURAHAN = '001' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340109000100900520' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340109000100900550' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340109000101101470' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir
) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '090' AND
B.KD_KELURAHAN = '001' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '090' AND
A.KD_KELURAHAN = '002' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '090' AND
B.KD_KELURAHAN = '002' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '090' AND
B.KD_KELURAHAN = '002' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '090' AND
A.KD_KELURAHAN = '003' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '090' AND
B.KD_KELURAHAN = '003' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '090' AND
B.KD_KELURAHAN = '003' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '090' AND
A.KD_KELURAHAN = '004' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.090.004.003-0127.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.090.004.013-0007.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '090' AND
B.KD_KELURAHAN = '004' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340109000400301270' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340109000401300070' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '090' AND
B.KD_KELURAHAN = '004' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '090' AND
A.KD_KELURAHAN = '005' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.090.005.003-0047.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.090.005.004-0197.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.090.005.006-0068.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.090.005.006-0105.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.090.005.007-0078.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.090.005.007-0209.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.090.005.010-0207.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.090.005.010-0208.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.090.005.010-0209.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '090' AND
B.KD_KELURAHAN = '005' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340109000500300470' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340109000500401970' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340109000500600680' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340109000500601050' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340109000500700780' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340109000500702090' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340109000501002070' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340109000501002080' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340109000501002090' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '090' AND
B.KD_KELURAHAN = '005' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '090' AND
A.KD_KELURAHAN = '006' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.090.006.019-0171.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.090.006.022-0065.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.090.006.022-0186.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '090' AND
B.KD_KELURAHAN = '006' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340109000601901710' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340109000602200650' AND
         (B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340109000602201860' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '090' AND
B.KD_KELURAHAN = '006' 


) F

)
UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '100' AND
A.KD_KELURAHAN = '001' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.100.001.008-0625.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.100.001.010-0405.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.100.001.010-0501.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '100' AND
B.KD_KELURAHAN = '001' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340110000100806250' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340110000101004050' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340110000101005010' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '100' AND
B.KD_KELURAHAN = '001' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '100' AND
A.KD_KELURAHAN = '002' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.100.002.013-0190.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '100' AND
B.KD_KELURAHAN = '002' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340110000201301900' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '100' AND
B.KD_KELURAHAN = '002' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '100' AND
A.KD_KELURAHAN = '003' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.100.003.036-0146.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '100' AND
B.KD_KELURAHAN = '003' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340110000303601460' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '100' AND
B.KD_KELURAHAN = '003' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '100' AND
A.KD_KELURAHAN = '004' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '100' AND
B.KD_KELURAHAN = '004' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '100' AND
B.KD_KELURAHAN = '004' 


) F

)
UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '110' AND
A.KD_KELURAHAN = '001' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '110' AND
B.KD_KELURAHAN = '001' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '110' AND
B.KD_KELURAHAN = '001' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '110' AND
A.KD_KELURAHAN = '002' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.110.002.011-0121.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '110' AND
B.KD_KELURAHAN = '002' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340111000201101210' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '110' AND
B.KD_KELURAHAN = '002' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '110' AND
A.KD_KELURAHAN = '003' AND
A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '110' AND
B.KD_KELURAHAN = '003' 
AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '110' AND
B.KD_KELURAHAN = '003' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '110' AND
A.KD_KELURAHAN = '004' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.110.004.012-0183.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '110' AND
B.KD_KELURAHAN = '004' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340111000401201830' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '110' AND
B.KD_KELURAHAN = '004' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '110' AND
A.KD_KELURAHAN = '005' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.110.005.009-0103.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '110' AND
B.KD_KELURAHAN = '005' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340111000500901030' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '110' AND
B.KD_KELURAHAN = '005' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '110' AND
A.KD_KELURAHAN = '006' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.110.006.018-0125.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.110.006.023-0248.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '110' AND
B.KD_KELURAHAN = '006' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340111000601801250' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340111000602302480' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '110' AND
B.KD_KELURAHAN = '006' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '110' AND
A.KD_KELURAHAN = '007' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.110.007.007-0407.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.110.007.027-0196.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '110' AND
B.KD_KELURAHAN = '007' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340111000700704070' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340111000702701960' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '110' AND
B.KD_KELURAHAN = '007' 


) F

)
UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '120' AND
A.KD_KELURAHAN = '001' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.120.001.011-0031.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.120.001.011-0150.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.120.001.011-0190.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.120.001.012-0635.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.120.001.012-0636.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.120.001.044-0096.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '120' AND
B.KD_KELURAHAN = '001' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340112000101100310' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340112000101101500' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340112000101101900' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340112000101206350' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340112000101206360' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340112000104400960' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '120' AND
B.KD_KELURAHAN = '001' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '120' AND
A.KD_KELURAHAN = '002' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.120.002.005-0264.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '120' AND
B.KD_KELURAHAN = '002' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340112000200502640' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '120' AND
B.KD_KELURAHAN = '002' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '120' AND
A.KD_KELURAHAN = '003' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.120.003.009-0159.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.120.003.018-0283.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
---(569628)-(803505)
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '120' AND
B.KD_KELURAHAN = '003' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340112000300901590' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340112000301802830' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '120' AND
B.KD_KELURAHAN = '003' 


) F

)

UNION ALL
---> BARU

SELECT  KODE_KEL, NM_KELURAHAN, THN_PAJAK_SPPT, JUMLAH_KETETAPAN_SPPT, JUMLAH_REALISASI_SPPT, KETETAPAN_RP, REALISASI_RP, ROUND((JUMLAH_REALISASI_SPPT_SEN/JUMLAH_KETETAPAN_SPPT_SEN),4)*100 PERSENTASE  FROM 
(SELECT F.KODE_KEL, F.NM_KELURAHAN, F.THN_PAJAK_SPPT, C.KETETAPAN_Rp , C.JUMLAH_KETETAPAN_SPPT, C.JUMLAH_KETETAPAN_SPPT_SEN, D.REALISASI_Rp, D.JUMLAH_REALISASI_SPPT, D.JUMLAH_REALISASI_SPPT_SEN

FROM 

(SELECT 
E.NM_KELURAHAN, (A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN) KODE_KEC,
(A.KD_PROPINSI||'.'||A.KD_DATI2||'.'||A.KD_KECAMATAN||'.'||A.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(A.PBB_YG_HARUS_DIBAYAR_SPPT)) KETETAPAN_Rp,
FORMAT_WITH_DOTS(COUNT(A.NO_URUT)) JUMLAH_KETETAPAN_SPPT, COUNT(A.NO_URUT) JUMLAH_KETETAPAN_SPPT_SEN FROM SPPT A, REF_KELURAHAN E
WHERE
E.KD_KECAMATAN = A.KD_KECAMATAN AND
E.KD_KELURAHAN = A.KD_KELURAHAN AND
A.THN_PAJAK_SPPT = :tahun AND
A.KD_PROPINSI = '34' AND
A.KD_DATI2 = '01' AND
A.KD_KECAMATAN = '120' AND
A.KD_KELURAHAN = '004' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.120.004.008-0060.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.120.004.020-0206.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.120.004.033-0082.0' AND
(A.KD_PROPINSI|| '.' ||A.KD_DATI2|| '.' ||A.KD_KECAMATAN|| '.' ||A.KD_KELURAHAN|| '.' ||A.KD_BLOK|| '-' ||A.NO_URUT|| '.' ||A.KD_JNS_OP) <>'34.01.120.004.055-0130.0' AND

A.STATUS_PEMBAYARAN_SPPT <>'2') C
 
CROSS JOIN

(SELECT 
E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
FORMAT_WITH_DOTS(COUNT(B.NO_URUT)) JUMLAH_REALISASI_SPPT, COUNT(B.NO_URUT) JUMLAH_REALISASI_SPPT_SEN FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '120' AND
B.KD_KELURAHAN = '004' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340112000400800600' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340112000402002060' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340112000403300820' AND
(B.KD_PROPINSI||B.KD_DATI2||B.KD_KECAMATAN||B.KD_KELURAHAN||B.KD_BLOK||B.NO_URUT||B.KD_JNS_OP) <>'340112000405501300' 

AND B.TGL_PEMBAYARAN_SPPT BETWEEN :tglawal AND :tglakhir

) D

CROSS JOIN



(SELECT DISTINCT
E.NM_KELURAHAN, B.THN_PAJAK_SPPT, 
(E.KD_PROPINSI||'.'||E.KD_DATI2||'.'||E.KD_KECAMATAN||'.'||E.KD_KELURAHAN) KODE_KEL
--E.NM_KELURAHAN,(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN) KODE_KEC,
--(B.KD_PROPINSI||'.'||B.KD_DATI2||'.'||B.KD_KECAMATAN||'.'||B.KD_KELURAHAN) KODE_KEL,
--FORMAT_WITH_DOTS(SUM(B.JML_SPPT_YG_DIBAYAR)) REALISASI_Rp,
--TO_CHAR (COUNT(B.NO_URUT),'9,999,999,999,999') JUMLAH_REALISASI_SPPT 
FROM PEMBAYARAN_SPPT B, REF_KELURAHAN E 
WHERE
B.KD_KECAMATAN = E.KD_KECAMATAN AND
B.KD_KELURAHAN = E.KD_KELURAHAN AND
B.THN_PAJAK_SPPT = :tahun AND
B.KD_PROPINSI = '34' AND
B.KD_DATI2 = '01' AND
B.KD_KECAMATAN = '120' AND
B.KD_KELURAHAN = '004' 

) F

)`;
        const queryParams = [tahun, tglawal, tglakhir];

        const result = await connection.execute(queryText, queryParams, { outFormat: oracledb.OUT_FORMAT_OBJECT });

        // Mengirim data yang berhasil diambil sebagai respons JSON
        res.status(200).json(result.rows);

    } catch (error) {
        console.error('Database query error:', error);
        res.status(500).json({ error: 'Internal Server Error.' });
    } finally {
        if (connection) {
            try {
                await connection.close(); // Pastikan koneksi ditutup
            } catch (err) {
                console.error(err);
            }
        }
    }
};